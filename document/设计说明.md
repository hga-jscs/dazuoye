# 程序设计说明（JSON 模块提取工具）

## 总体思路
程序按“读取 → 建图 → 子图枚举 → 输出”的流水线方式组织，每一步都独立成模块，便于维护与自动化测试。重点强调**正确性优先**，并提供可视化的调试输出，方便人工核对。

## 模块划分
- **JsonLoader**：负责从文件读取 JSON，解析失败时输出错误信息。
- **Graph**：
  - 基于节点 `id` 构建索引。
  - 解析 `wires` 与属性引用，形成有向连接。
  - 同时维护无向连接用于连通性判定。
- **SubgraphEnumerator**：
  - 枚举满足规模限制的子图。
  - 默认采用无向连通子图枚举，减少爆炸式组合。
  - 校验“结点信息封闭”（子图内节点不允许引用子图外节点）。
- **ModuleWriter**：将子图内节点以 JSON 数组输出，并按规则命名。
- **PlusConfig**：通过 `plusconfig.json` 启用扩展功能。

## 关键算法说明

### 1. 连接构建
- `wires` 关系：若配置 `use_all_wires=false`，仅使用 `wires[0]`；否则使用全部 `wires` 子数组。
- 属性关系：递归遍历节点 JSON（跳过 `wires` 与 `id`），若字符串值与已有 `id` 匹配，则建立有向边。
- 忽略标签：若某属性名在忽略列表中，则该属性及其子结构不参与连接构建。

### 2. 子图枚举
- 默认 **连通子图** 枚举：
  - 以每个节点作为最小索引根，递归扩展其无向邻居集合。
  - 保证枚举结果唯一性且满足连通要求。
- 若 `allow_disconnected=true`，则采用全集组合枚举。

### 3. 结点信息封闭
- 对任一子图，若子图内节点存在有向连接指向子图外节点，则该子图判定为非法。
- 该规则避免输出带“悬空引用”的模块文件。

## 调试输出
程序会输出：
- 节点总数、连接数、节点列表。
- 每个模块文件的节点数量与节点列表。

这些信息便于直接在终端中“可视化”检查子图构造是否符合预期。

## Plus 配置（扩展功能）
在输入目录的上级目录或当前目录下放置 `plusconfig.json`，可控制额外功能：

```json
{
  "use_all_wires": false,
  "allow_disconnected": false,
  "verbose_debug": true
}
```

- `use_all_wires`：是否使用所有 `wires` 子数组建图。
- `allow_disconnected`：是否允许不连通子图。
- `verbose_debug`：是否输出详细调试信息。

## 运行方式（Python）
```bash
# 处理单个文件
python3 mytool "json 230902/1.json" 5 6 z

# 处理目录（自动遍历）
python3 mytool "json 230902" 5 6 z
```

> 说明：程序使用 Python 标准库 `json` 解析文件，不依赖额外第三方库。
